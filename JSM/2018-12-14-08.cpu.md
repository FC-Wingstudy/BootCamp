# 08.cpu

## 트랜지스터와 논리 게이트

### 전압, 전류, 저항
전기의 특성에는 전압, 전류, 저항이 있다. 전압은 수압과 매우 비슷하다. 전압이 높다는 말은 수위가 높은 댐 안에 갇힌 물의 수압을 떠올리면 되고, 전압이 낮다는 말은 평평한 곳에 흐르는 물의 수압을 떠올리면 된다. 
<br>
<br>
이번에는 댐이 아니라 좁은 통로로 물이 흐른다고 가정해보자. 높은 수압을 가진 물이 좁은 통로로 한 번에 나가려고 하면 통로에 엄청난 압력이 가해질 것이다. 통로가 좁아질수록 압력이 세지고 흐르는 물의 양은 줄어든다. 여기서 압력은 '저항'에 해당하고 물의 양은 '전류'에 해당한다. 즉, 저항이 세지면 전류는 줄어든다.
<br>
<br>
전압, 전류, 저항에 대해 이해했다면 이제 '전압 강하'의 개념을 살펴보자. 높은 전압을 가지고 있다가 좁은 통로인 저항을 지나는 순간 전압이 완전히 낮아진다. 이렇게 저항을 지나면서 전압이 낮아지는 것을 '전압 강하'라고 한다. 


## 조합 논리 회로와 가산기

### CPU의 구성
ALU, CU, IR, PC

cpu를 보면 cu라고 적힌 공간이 있다. cu(Control Unit)는 제어 장치이다. 우리가 작성한 코드는 컴퓨터가 이해할 수 있는 언어인 기계어(0과 1로 이루어짐)로 번역되어 메모리에 저장된다. 이후 프로그램이 실행되면 CPU는 이 명령어를 한 줄씩 읽어 들여 실행한다. 이때 어떤 명령어인지 해석하고 이를 실행하려고 할 때 CPU의 각 파트에 지시를 내리는 역할을 하는 것이 제어 장치이다.
<br>
<br>
ALU(Arithmetic Logic Unit, 산술 논리 연산 장치) 덧셈, 뺄셈 같은 논리 연산을 하는 곳이다. ALU와 CU를 제외한 AX, BX, IR, PC는 모두 레지스터이다. 

<br>
<br>

조합 논리 회로는 현재 입력에 의해서만 출력이 결정되는 논리 회로를 말한다. 가산기는 ALU 내부에 위치하고 레지스터 AX와 BX 값을 입력 받는다. 

<br>
### 가산기
가산기에는 단순히 비트 두 개만 더하는 반가산기와 캐리(carry)까지 연산에 포함하는 전가산기가 있다. 전가산기는 반가산기 두 개와 OR 게이트 한 개로 이루어져 있다. 

<br>
<br>

## 순차 논리 회로와 레지스터
순차 논리 회로는 현재의 출력이 현재의 입려과 과거의 출력에 따라 정해지는 논리 회로이다. 현재 출력이 과거 출력에 영향을 받는다는건 어떤 의미일까? 우선 두 가지를 유심히 봐야한다. 먼저 출력이 분기되어 다시 입력으로 들어온다는 것이다. 현재의 출력이 현재의 입력과 함께 지난번 출력으로 결정된다. 둘째로 Q의 값이 특정한 값일 때만 바뀐다는 점이다.

<br>
<br>
우리가 확인할 것은 입력이 바뀌었다고 해서 출력이 바로 바뀌는 것이 아니라 특정 상황이 되었을 때만 바뀐다는 점과 이를 통해 이전 출력 값이 유지된다는 점이다. 출력 값이 '유지'된다는 특성을 다르게 표현하면 '저장'된다고 할 수 있다.

## 클록
클록에 대해 알아보기 전에 주파수와 주기가 무엇인지 알아보자. 진자가 1초 동안 왕복한 횟수를 주파수라고 한다. 전자가 1초 동안 두 번 왕복했을 대의 주파수를 국제단위계로 표현하면 다음과 같다.
<br>
<br>
```
f = 2Hz = 2cycle/sec
```
<br>
<br>
2헤르츠(Hz)라고 읽고 '진자가 1초 동안 두 번 왕복했다' 또는 '진자가 한 번 왕복하는데 0.5초가 걸린다'라고 표현하기도 한다. 주파수와 주기는 반비례 관계이다. 

<br>
<br>
클록 속도는 CPU 혹은 프로세서 속도의 지표로 1초에 클록이 몇 번 발생했는가를 의미한다. 컴퓨터 내부에는 클록 발생기가 있는데 이 발생기는 일정한 시간에 맞춰 펄스를 생성한다. 
<br>
클록 펄스는 일반적으로 상승 에지에 맞춰 인스트럭션을 실행한다. 인스트럭션이란 우리가 작성한 코드가 CPU에서 실행되기 위해 최종적으로 반환된 기계어 명령어이다. 모든 에지마다 인스트럭션을 하나씩 실행하는 것은 아니지만 클록 주파수가 높을수록 1초당 상승 에지 수가 높아지고 그만큼 실행되는 인스트럭션 수도 늘어날 테니 CPU의 주파수가 높을수록 연산 속도가 빠른 성능 좋은 컴퓨터이다.

## 시스템 버스
* IR(Instruction Register) 기계어로 번역하면 최소 네 개의 명령으로 변환한다. 변환된 명령어는 프로그램을 실행하면 메인 메모리에 올려지고 하나씩 실행되는데 이때 메모리에 있는 명령어를 CPU로 가져와 저장해 두는 곳이 IR이다.
* PC(Program Counter)현재 실행 중인 명령어 다음에 실행될 명령어의 메모리 주소를 담고 있다.
* AX, Bx AX와 BX는 범용 레지스터라고 부른다. 주로 메모리에서 읽어 들인 데이터를 저장했다가 ALU가 연산할 때 피연산자로 전달하거나 연산 결과 값을 저장할 때 쓴다.

### 시스템 버스의 구성과 특징
사실 시스템 버스는 CPU와 메모리에 국한된 이야기는 아니다. CPU, I/O, 주변 장치 모두 시스템 버스를 통해 데이터를 주고받는다.

* 데이터 버스(Data Bus)제어 버스의 신호에 따라 데이터를 CPU에서 메모리로 전송하거나 반대로 메모리에서 CPU로 전송한다. 그러므로 데이터 버스는 양방향이어야 한다.
* 제어 버스(Control Bus) 데이터를 레지스터로 읽어올지(READ) 아니면 메모리에 쓸지(WRITE) CPU가 메모리에 전달한다.
* 주소버스(Address Bus) 메모리에서 레지스터로 혹은 레지스터에서 메모리로 데이터를 전송할 때 필요한 메모리 주소를 전달한다. CPU가 메모리에 알려 주는 형식이므로 단방향이다.


## 인스트럭션 세트

인스트럭션 세트란 CPU가 인식하여 실행할 수 있는 기계어이다. 기계어는 바이너리 형태라 사람이 읽기 어렵다. 어셈블리어는 기계어를 사람이 읽을 수 있도록 일대일로 대응한 문자 형태의 명령어이다. 인스트럭션 세트는 CPU마다 다르다. 새로운 CPU를 도입했다면 그 CPU에 적합한 인스트럭션 세트로 다시 프로그래밍해야 한다. 이러한 불편을 없애고자 C 언어를 비롯한 하이레벨 언어가 탄생한 것이다. 컴파일 언어는 작성한 코드는 그대로 두고 작동하는 컴퓨터에 따라 컴파일만 다시 하면 된다.