# 04.문자와 문자열

## 아스키코드
문자 인코딩은 문자집합을 메모리에 저장하거나 통신하는 데 사용하기 위해 부호화하는 방식을 말한다. 대표적으로 모스부호가 있다.

0과 1밖에 모르는 컴퓨터에 문자를 인식시키려면 문자를 0과 1로 이주어진 2진수로 나타내야한다.

문자 하나에 정수 하나를 매핑해 두면 이 정수는 특정 문자를 표현하게 된다. 이렇게 매핑된 정수를 `코드 포인트`라고 한다. 문자와 문자에 매핑된 코드 포인트를 모아 놓은 집합을 `부호화된 문자 집합` 이라고 부른다.

아스키는 대표적인 문자 인코딩 방식이다. 비트 7개로 문자를 표현하므로 문자를 총 128개까지 표현할 수 있다. `당연히 코드 포인트 수 또한 128개` 

아스키코드를 보면 정수 0부터 127까지 문자와 매핑이 되어있다. `2진수로  0000 0000(0)` 부터 `0111 1111(127)`까지 이므로 표현하는 데 최대 7비트가 필요하다.

정수를 나타내는데 쓰는 자료형은 바이트 수에 따라 다양한데, int형이 가장 많이 쓰이고 있다. int형은 32비트 컴퓨터에서 일반적으로 4바이트이다. 이보다 작은 short형은 2바이트(16비트)이다. 
> 아스키 코드를 표현하는데 7비트면 충분하기 때문에 int형이나 short형을 쓰면 메모리가 낭비되게 된다. 때문에 문자를 표현하기 위해 char형이라는 새로운 정수 자료형을 만들게 된다. 문자를 담기 위해 만들어진 자료형이지만 정수 자료형이기 때문에 작은 수를 표현하는 데 사용하기도 한다.

## 유니코드
아스키코드를 보면 알파벳만 있고 한글이 없다. 전 세계적으로 컴퓨터가 보급되면서 컴퓨터에서 쓸 수 있는 언어가 좀 더 많이 필요해졌다. 이때 나온 해결 방법이 7비트로 표현한 문자를 16비트로 확장하는 방법이다. 7비트일 때는 128개 문자를 표현할 수 있지만 16비트로 확장하면 65,536개 문자를 표현할 수 있다. 여기에 더해 수 하나에 다시 문자 하나를 이대일로 대응한 새로운 표를 만들었는데, 이 테이블이 바로 `유니코드`이다.

아예 처음부터 새로이 한 것은 아니고 아스키코드인 `0x0000`부터`0X007F` (2진수 0000 0000 0000 0000 ~ 0000 0000 0111 1111 즉, 기존 아스키 코드 앞에 0으로 채워진 8비트를 붙인것)까지는 그대로 유지를 하고 이후 부터 숫자 하나에 문자하나를 대응 하였다. 
> 유니코드를 만든 사람은 언젠가 2바이트로 부족한 날을 대비하여 언어 대부분이 포함된 첫 번째 테이블을 기본 다국어 평면(BMP)이라 이름짓고 이런 테이블을 총 17개를 준비해 두었다.

```
기본 다국어 평면에서 한글은 U+AC00부터 
U+D7AF까지에 자리 잡고 있다.
U+는 유니코드라는 의미고 2바이트 수인 AC 00은 한글 '가'를 의미한다.

```

## 유니코드 인코딩 방식

코드유닛은 코드 포인트를 특정한 방법으로 인코딩했을 때 변환되어 얻어지는 비트의 나열을 말한다. 

문자 인코딩 방식은 코드 유닛을 옥텟으로 나열하여 변환하는 방법이다. 옥텟은 데이터의 단위로 8비트를 의미한다. 지금은 1바이트를 당연히 8비트라고 생각하지만 예전에는 1바이트가 반드시 8비트가 아니였기에 옥텟이라는 명칭을 사용했다.

유니코드는 2바이트로 숫자 하나에 문자 하나를 대응하여 문자를 표현한다. 기본 다국어 평면을 포함해 평면이 모두 17개 있으므로 모든 문자를 표현 하려면 3바이트가 필요하다. 

만약 1바이트 정수만 저장할 수 있는 시스템이라면 3바이트짜리 정수는 저장할 수 없으므로 이 시스템에서는 한글을 표현할 수 없다. 그렇기 때문에 다양한 코드 유닛을 갖는 인코딩 방식을 두어 유연하게 대처해야한다. 

### UTF-8
UTF-8은 유니코드 인코딩 방식 중 하나로 유니코드 문자 하나를 1바이트에서 4바이트 사이에서 표현한다. 유니코드 포인트가 `U+0000 ~ U+007F`는 `1바이트`, `U+0080 ~ U+07FF`는 `2바이트`, `U+0800 ~ U+FFFF`는 `3바이트`, 나머지는 4바이트로 표현한다. 문자에 따라 바이트 수가 달라지므로 가변 길이 인코딩 방식이라고 부른다.
> u8"가"; 에서 u8은 UTF-8을 의미한다.

UTF-8에서 코드 포인트가 U+0800에서 U+FFFF사이인 문자는 다음과 같은 포맷으로 변환된다. ` 1110xxxx 10xxxxxx 10xxxxxx`
이 포맷에서 맨 앞에 있는 111은 바이트 수를 나타낸다. 1바이트로 표현하면 1, 2바이트로 표현하면 11, 3바이트로 표현하면 111이다. X로 표시된 부분은 문자의 코드 포인트를 2진수로 변환한 후 차례대로 채우게 된다.

문자'가'의 코드 포인트 U+AC00을 2진수로 표현하면 다음과 같다. 
`1010 1100 0000 0000`
포맷의 x를 보면 첫번째 등장하는 x는 4자리, 다음은 6자리, 마지막 6자리 이다. 이 자리에 맞춰 2진수로 변환한 '가'의 코드 포인트를 채워주면 된다.
`11101010 10110000 10000000` 
이를 16진수로 변환하면 `0xEAB080`이다.

### UTF-16
UTF-16도 유니코드 인코딩 방식 중 하나로 2바이트 단위로 문자를 표현한다. 해당 문자가 기본 다국어 평면에 존재하면 2바이트로 인코딩 되고, 그렇지 않으면 4바이트로 인코딩된다. 코드 유닛의 크기는 16비트이다. UTF-16을 나타낼때 문자열 앞에 소문자 `u`가 붙는다.

문자열 '가'가 UTF-16으로 인코딩 되어 메모리에 담긴 모습은 문자열 '가'의 코드포인트인 AC00을 바이트 단위로 순서만 바꾸면 메모리에 담긴 모습이 된다. `00 ac`

### UTF-32
UTF-32	도 유니코드 인코딩 방식의 하나로 모든 문자를 4바이트로 표현한다. 코드 유닛의 크기는 32 비트이다.

UTF-32는 모든 문자를 4바이트 단위로 인코딩 하므로 기본 다국어 평면의 문자뿐만 아니라 모든 평면에 있는 문자를 한 개 단위로 담을 수 있다. UTF-32를 표현 할때는 문자열 앞에 대문자 `U`가 붙는다. 문자열 '가'를 UTF-32로 인코딩하여 메모리에 담긴 모습은 `00 ac 00 00`이 된다.


## 파이썬 문자열의 특징
C/C++에서는 문자열을 변수로 만들면 요소인 문자를 변경할 수 있고, 문자열을 상수로 만들면 요소를 변경할 수 없다. 즉, 프로그래머가 변경 가능성을 선택할 수 있다. 하지만 파이썬의 문자열은 요소를 변경할 수 없다.

파이썬에서 문자열 요소를 변경하려면 문자열 슬라이싱을 사용해야 하는데 두 가지 방법이 있다. 

```
>>> string = 'abcde'
>>> new_string = string[:2] + 'x' + string[3:]
>>> new_string
'abxde'
```
위와 같은 내부함수를 사용하지 않는 방법이 있고 내부함수인 `replace()`를 사용하는 방법이 있다.

```
>>> string = 'abcde'
>>> new_string = string.replace('c', 'x')
>>> new_string
'abxde'
>>> string
'abcde'
```


## 마치며

프로그래밍을 하다보면 문자가 깨지는 현상이 발생하는데, 문자 인코딩에 대해 정확한 지식을 갖춰 두면 문제를 빠르게 파악할 수 있어 매우 유용하게 사용할 수 있다.


